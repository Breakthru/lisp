(setq reverse '(
(q0 a l q1)
(q0 b l q1)
(q0 c l q1)
(q1 BL $ q1)
(q1 $ r q2)
(q2 a r q2)
(q2 b r q2)
(q2 c r q2)
(q2 BL * q3)
(q3 BL l q3)
(q3 $ BL q11)
(q3 a BL q9)
(q3 c BL q4)
(q3 b BL q7)
(q3 * l q3)
(q4 BL r q4)
(q4 * r q5)
(q5 a r q5)
(q5 b r q5)
(q5 c r q5)
(q5 BL c q6)
(q6 a l q6)
(q6 b l q6)
(q6 c l q6)
(q6 * l q3)
(q7 BL r q7)
(q7 * r q8)
(q8 a r q8)
(q8 b r q8)
(q8 c r q8)
(q8 BL b q6)
(q9 BL r q9)
(q9 * r q10)
(q10 a r q10)
(q10 b r q10)
(q10 c r q10)
(q10 BL a q6)
(q11 BL r q11)
(q11 * BL q12)
)
)

(DEFUN mdtrev (SIN STATO DES)
 (DO NIL (NIL NIL) (STAMPAID SIN STATO DES)
  (COND
   ((AND (EQ STATO 'Q0) (EQ (CAR DES) 'A)) (SETQ STATO 'Q1)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q0) (EQ (CAR DES) 'B)) (SETQ STATO 'Q1)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q0) (EQ (CAR DES) 'C)) (SETQ STATO 'Q1)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q1) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q1)
    (SETQ DES (CONS '$ (CDR DES))))
   ((AND (EQ STATO 'Q1) (EQ (CAR DES) '$)) (SETQ STATO 'Q2)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q2) (EQ (CAR DES) 'A)) (SETQ STATO 'Q2)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q2) (EQ (CAR DES) 'B)) (SETQ STATO 'Q2)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q2) (EQ (CAR DES) 'C)) (SETQ STATO 'Q2)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q2) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q3)
    (SETQ DES (CONS '* (CDR DES))))
   ((AND (EQ STATO 'Q3) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q3)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q3) (EQ (CAR DES) '$)) (SETQ STATO 'Q11)
    (SETQ DES (CONS 'BL (CDR DES))))
   ((AND (EQ STATO 'Q3) (EQ (CAR DES) 'A)) (SETQ STATO 'Q9)
    (SETQ DES (CONS 'BL (CDR DES))))
   ((AND (EQ STATO 'Q3) (EQ (CAR DES) 'C)) (SETQ STATO 'Q4)
    (SETQ DES (CONS 'BL (CDR DES))))
   ((AND (EQ STATO 'Q3) (EQ (CAR DES) 'B)) (SETQ STATO 'Q7)
    (SETQ DES (CONS 'BL (CDR DES))))
   ((AND (EQ STATO 'Q3) (EQ (CAR DES) '*)) (SETQ STATO 'Q3)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q4) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q4)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q4) (EQ (CAR DES) '*)) (SETQ STATO 'Q5)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q5) (EQ (CAR DES) 'A)) (SETQ STATO 'Q5)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q5) (EQ (CAR DES) 'B)) (SETQ STATO 'Q5)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q5) (EQ (CAR DES) 'C)) (SETQ STATO 'Q5)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q5) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q6)
    (SETQ DES (CONS 'C (CDR DES))))
   ((AND (EQ STATO 'Q6) (EQ (CAR DES) 'A)) (SETQ STATO 'Q6)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q6) (EQ (CAR DES) 'B)) (SETQ STATO 'Q6)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q6) (EQ (CAR DES) 'C)) (SETQ STATO 'Q6)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q6) (EQ (CAR DES) '*)) (SETQ STATO 'Q3)
    (COND ((NULL SIN) (SETQ SIN '(BL)))) (SETQ DES (CONS (CAR SIN) DES))
    (SETQ SIN (CDR SIN)))
   ((AND (EQ STATO 'Q7) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q7)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q7) (EQ (CAR DES) '*)) (SETQ STATO 'Q8)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q8) (EQ (CAR DES) 'A)) (SETQ STATO 'Q8)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q8) (EQ (CAR DES) 'B)) (SETQ STATO 'Q8)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q8) (EQ (CAR DES) 'C)) (SETQ STATO 'Q8)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q8) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q6)
    (SETQ DES (CONS 'B (CDR DES))))
   ((AND (EQ STATO 'Q9) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q9)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q9) (EQ (CAR DES) '*)) (SETQ STATO 'Q10)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q10) (EQ (CAR DES) 'A)) (SETQ STATO 'Q10)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q10) (EQ (CAR DES) 'B)) (SETQ STATO 'Q10)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q10) (EQ (CAR DES) 'C)) (SETQ STATO 'Q10)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q10) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q6)
    (SETQ DES (CONS 'A (CDR DES))))
   ((AND (EQ STATO 'Q11) (EQ (CAR DES) 'BL)) (SETQ STATO 'Q11)
    (SETQ SIN (CONS (CAR DES) SIN)) (SETQ DES (CDR DES))
    (COND ((NULL DES) (SETQ DES '(BL)))))
   ((AND (EQ STATO 'Q11) (EQ (CAR DES) '*)) (SETQ STATO 'Q12)
    (SETQ DES (CONS 'BL (CDR DES))))
   (T (RETURN '(FINE DEL CALCOLO)))))
)
